\chapter{1階述語論理の統語論}
\label[chapter]{chap:syntax}

本章では，1階述語論理と呼ばれる体系の統語論について述べる．
統語論とは，雑に述べると「文の構造」についての理論である．
この「文」は，ここでは「数学における何らかの主張」に対応する．
つまり，ここで議論したいのは
「数学における何らかの主張はどのような要素がどう組み合わさってできているのか」
ということである．
このことを議論するための足掛かりとして，我々は\cref{chap:formulize}で述べた方針に従い
「何ら素朴的直観が関与しない形式的な記号列の世界」において
論理式という概念を構成していく．

形式的記号列の世界での定義により，何を議論の対象とし，何を議論の対象としないのかが明瞭となる．
これにより，通常の数学と同じく一般的な法則や定理を研究することが可能となる．
本章の内容はその前準備に相当する．

\newpage

\section{言語} \label[seciton]{sec:language}

議論を始めるにあたり，どのような記号を使用するのかを明瞭にする必要がある．
まず，通常の数学においてはどうなっているかを振り返ろう．

\begin{Ex} \label[Ex]{Ex:informalsymbol}
	群論においては，単位元を表す記号「\(\obj{e}\)」，2項演算を表す記号
	「\(\obj{\mathord{\ast}}\)」，逆元を表す記号「\({}^{\obj{-1}}\)」が用いられる．
	また，順序の理論においては，順序を表す記号「\(\obj{\le}\)」が用いられる．

	この他，「\(\obj{x}\)」や「\(\obj{y}\)」等の変数を表す記号やカッコ「\(\lparen\)」「\(\rparen\)」や
	カンマ「\(,\)」等は共通して用いられる．
\end{Ex}

\Cref{Ex:informalsymbol}では，対象の理論に依存して必要であったりそうでなかったりする記号と
共通して用いられる記号があった．
そのような記号を\cref{tab:commonsymbol}に示し，今後逐一言及しないものとする%
\footnote{%
	ここに示す記号とは違う記号を採用する場合もあるが，それは単に流儀や議論の対象の違いである．
	その違いによって質的に大きな差異が生じることもあればそうでないこともある．
}%
．

\begin{table}[htbp]
	\centering
	\caption{数学理論で共通して用いられる記号}
	\label{tab:commonsymbol}
	\begin{tabular}{ccc}
		\toprule
		種別   & 一覧                                                                   & 備考              \\
		\midrule
		変数記号 & \(\obj{x}, \obj{y}, \obj{z}, \dotsc\)                                & 無限に多く存在する（可算無限） \\
		論理記号 & \(\bot, \lnot, \land, \lor, \to, \forall, \exists\)                                    \\
		等号   & \(\obj{\mathord{\objeq}}\)                                           & オブジェクト側の意味での等号  \\
		補助記号 & \(\text{``\(\lparen\)''}, \text{``\(\rparen\)''}, \text{``\(,\)''}\) & カッコやカンマ         \\
		\bottomrule
	\end{tabular}
\end{table}

「名称」列に「変数記号」や「論理記号」等の名前が定義なしに入っているが，これは単にそういう区分けができることのみが要請される．
また，変数記号については無限に多く存在することが要請されているが，これについてはすでにいくつか記号が登場している状況下において
そのいずれとも異なる変数記号をいつでも用意できることを期待しての要請である．

さて，\cref{tab:commonsymbol}に追加で記号を付け加えることにより，各理論の特色が現れる．

\begin{Def} \label{def:language}
	記号の集合\(\symcal{L}\)が%
	\index[widx]{げんご@言語}%
	\term{言語}であるとは，\(\symcal{L}\)の元が以下の3種類に区分けされていることをいう：
	\begin{itemize}
		\item \index[widx]{ていすうきごう@定数記号}定数記号
		\item \index[widx]{かんすうきごう@関数記号}関数記号，\index[widx]{ありてぃ@アリティ}\term{アリティ}と呼ばれる正の整数\(n\)をもつ
		\item \index[widx]{かんけいきごう@関係記号}関係記号，\index[widx]{ありてぃ@アリティ}アリティと呼ばれる正の整数\(n\)をもつ
	\end{itemize}
\end{Def}

「定数記号」や「関数記号」という字面はいかにも我々の素朴的直観を呼び起こしそうであるが，
ここでは単にそういう名称で区分けできるということだけを要請しているに過ぎない．
アリティについても同様である．「この関数記号のアリティはいくつですか？」に対して「2です」のような
解答を返せることを要請しているに過ぎない．

言語については，例を述べるのがわかりやすいだろう．

\begin{Ex} \label[Ex]{Ex:languageexample}
	群論の言語\(\symcal{L}_1\)は\(\symcal{L}_1 = \set{\obj{\ast}, \obj{e}, {}^{\obj{-1}}}\)
	と与えることができる．ここで，\(\obj{\ast}\)はアリティ2の関数記号，\(\obj{e}\)は定数記号，
	\({}^{\obj{-1}}\)はアリティ1の関数記号である．
	また，順序の理論の言語\(\symcal{L}_2\)は\(\symcal{L}_2 = \set{\obj{\le}}\)と与えることができる．
	ここで，\(\obj{\le}\)はアリティ2の関係記号である．
\end{Ex}

アリティというのは，素朴的直観における「引数の数」の対応物だと考えられる．
こう考えてみれば，関数記号や関係記号にアリティが定まっていることを要請するのはごく自然であろう．


\section{項と論理式} \label[section]{sec:logicalexpression}

使う記号を定義したことで，これらを組み合わせて「モノ」や「主張」に相当する概念を構築していくことができる．
これは言語に対してある種の「文法」を定めることに相当する．
文法を定めることにより，形式的記号の集合でしかなかった言語が一気に「数学っぽい」性格を帯びてくる．

\index[widx]{こう@項}
\begin{Def} \label[Def]{Def:term}
	言語\(\symcal{L}\)に対し，\(\symcal{L}\)項を以下のように帰納的に定義する：
	\begin{enumerate}
		\item 変数記号は\(\symcal{L}\)項である．
		\item 定数記号は\(\symcal{L}\)項である．
		\item \(f\)が\(\symcal{L}\)におけるアリティ\(n\)の関数記号であり%
		      \footnote{%
			      ここで\(f\)がイタリック体なのは，「\(f\)」という記号そのものが\(\symcal{L}\)の関数記号というわけではなく
			      \(\symcal{L}\)の関数記号のうちのどれかであるということを明示することを意図している．
		      }%
		      ，
		      \(t_1, t_2, \dotsc, t_n\)が\(\symcal{L}\)項であるならば，記号列
		      \begin{equation}
			      \apply{f}{t_1, t_2, \dotsc, t_n}
		      \end{equation}
		      は\(\symcal{L}\)項である．
		\item 以上の規則を有限回適用して得られるもののみが項である．
	\end{enumerate}
\end{Def}


\begin{Ex} \label[Ex]{Ex:groupterm}
	\Cref{Ex:languageexample}で述べた群論の言語\(\symcal{L}_1\)において，
	\(\apply{\obj{\ast}}{\obj{x}, \obj{y}}, \obj{e}, \apply{\obj{\ast}}{\apply{\obj{\ast}}{\obj{e}, \obj{x}}, \obj{y}}\)は
	いずれも\(\symcal{L}_1\)項である．ここで，\(\obj{x}, \obj{y}\)は変数記号である．
	なお，順序の理論の言語\(\symcal{L}_2\)は定数記号も関数記号ももたないため，
	\(\symcal{L}_2\)項は変数記号のみである．
\end{Ex}

\begin{Que} \label{Que:termexample}
	\Cref{Def:term}に基づき，\cref{Ex:groupterm}における
	「\(\apply{\obj{\ast}}{\apply{\obj{\ast}}{\obj{e}, \obj{x}}, \obj{y}}\)」
	が\(\symcal{L}_1\)項であることを確かめよ．
	また，記号列「\(\obj{e} \apply{\mathord{\obj{\ast}}}{\obj{e}, \obj{e}}\)」が\(\symcal{L}_1\)項でないことを確かめよ．
\end{Que}



\begin{Def} \label[Def]{Def:logicalexpression}
	言語\(\symcal{L}\)に対し，\(\symcal{L}\)論理式を以下のように帰納的に定義する：
	\begin{enumerate}
		\item \(\bot\)は論理式である．
		\item \(t_1, t_2\)が\(\symcal{L}\)項であるならば，記号列
		      \begin{equation}
			      \paren{t_1 \obj{\objeq} t_2}
		      \end{equation}
		      は\(\symcal{L}\)論理式である．
		\item \(r\)が\(\symcal{L}\)におけるアリティ\(n\)の関係記号であり%
		      \footnote{%
			      \Cref{Def:term}のときと同様の理由で\(r\)はイタリック体としている．
		      }%
		      ，\(t_1, t_2, \dotsc, t_n\)が\(\symcal{L}\)項であるならば，
		      記号列
		      \begin{equation}
			      \apply{r}{t_1, t_2, \dotsc, t_n}
		      \end{equation}
		      は\(\symcal{L}\)論理式である．
		\item \(\varphi, \psi\)が論理式で\(x\)が変数記号であるならば，
		      記号列
		      \begin{align}
			      \paren{\lnot \varphi},      \\
			      \paren{\varphi \land \psi}, \\
			      \paren{\varphi \lor \psi},  \\
			      \paren{\varphi \to \psi},   \\
			      \paren{\forall x \varphi},  \\
			      \paren{\exists x \varphi}
		      \end{align}
		      はいずれも\(\symcal{L}\)論理式である．
		\item 以上の規則を有限回適用して得られるもののみが論理式である．
	\end{enumerate}
\end{Def}

\begin{Ex} \label[Ex]{Ex:logicalexpression}
	群論の言語\(\symcal{L}_1\)において，
	\(\paren{\apply{\obj{\ast}}{\obj{x}, \obj{y}} \obj{\objeq} \apply{\obj{\ast}}{\obj{y}, \obj{x}}}\)は
	\(\symcal{L}_1\)論理式である．また，順序の理論の言語\(\symcal{L}_2\)において，
	\(\paren{ \forall \obj{y} \mathord{\obj{\le}}\paren{ \obj{x}, \obj{y}} }\)や
	\(\paren{ \forall \obj{x} \paren{ \forall \obj{y}\apply{\mathord{\obj{\le}}}{\obj{x}, \obj{y}}} }\)は
	いずれも\(\symcal{L_2}\)論理式である．ここで，\(\obj{x}, \obj{y}\)は変数記号である．
\end{Ex}

論理式でない記号列の例も挙げておこう．

\begin{Ex} \label[Ex]{Ex:nologicalexpression}
	言語\(\symcal{L}\)において，\(\obj{x}\)が変数記号であるとき，
	記号列\(\paren{\exists \obj{x} \paren{\obj{x}}}\)は\(\symcal{L}\)論理式ではない．
	一方で，\(\paren{\exists \obj{x} \paren{\obj{x} \obj{\objeq} \obj{x}}}\)は\(\symcal{L}\)論理式である．
	また，群論の言語\(\symcal{L}_1\)において，\(\paren{\forall \obj{x} \paren{\obj{x} \obj{\ast} \obj{e} \objeq \obj{x}}}\)や
	\(\forall \obj{x} \paren{ \obj{x} \obj{\objeq} \obj{x}}\)はいずれも
	\emph{\cref{Def:logicalexpression}で述べた意味においては}\(\symcal{L}_1\)論理式ではない．
\end{Ex}

\begin{Que} \label[Que]{Que:logicalexpression}
	\Cref{Def:logicalexpression}に基づき，\cref{Ex:logicalexpression}と\cref{Ex:nologicalexpression}で
	挙げた各式について，それが実際に論理式であることやそうでないことを確かめよ．
\end{Que}

\begin{Note} \label[Note]{Note:logicalexpression}
	\Cref{Ex:nologicalexpression}の後半で「\cref{Def:logicalexpression}で述べた意味においては」
	と述べたのは，
	それなりに妥当性のある略記表現に関する約束事を適切に定めることにより，
	これらが論理式であるようにみなせるからである．
	例えば，以下のように約束することが多い：
	\begin{itemize}
		\item 対象の論理式がどのようにして構成されたかにあいまいさが生じない範囲でかっこは省略してよい．
		\item 論理記号\(\lnot, \land, \lor, \to, \forall, \exists\)たちの結合の優先順位については，
		      \(\lnot, \forall, \exists\)がもっとも高く，次に\(\land, \lor\)が高く，
		      もっとも低いのが\(\to\)であると約束する．
		\item アリティ2の関数記号や関係記号については，\(\obj{x} \obj{\ast} \obj{y}\)や\(\obj{x} \le \obj{y}\)のように
		      その記号が真ん中に来るように配置して表記してよい．
	\end{itemize}
	こうすると，\(\paren{\paren{\varphi \land \paren{\lnot \psi}} \to \xi}\)は\(\varphi \land \lnot \psi \to \xi\)のように見やすくできる．
	これは，通常の数学における数の演算において，\(\mathord{\times}\)が\(\mathord{+}\)よりも優先度が高いとみなして
	\(\paren{\paren{2 \times 3} + 4} = 2 \times 3 + 4\)と略記することで可読性の向上を図るのとまったく同じである．
	これは人間が目で見る際に楽をするための約束事であって，数学的な議論の帰結ではないことに注意しておこう．
	本書でも，これらの略記表現を積極的に利用する．
\end{Note}

\begin{Note} \label[Note]{Note:languageomission}
	ここまで「言語\(\symcal{L}\)において」とか「\(\symcal{L}\)項」のように，用いる言語を明示して議論を進めてきた．
	しかし，以下で行われるのは特定の言語に依存しない議論がほとんどである．
	そのため，特に断りがない限りは「言語\(\symcal{L}\)」の表記は省略することとする．
	「\(\symcal{L}\)項」や「\(\symcal{L}\)論理式」は単に「項」や「論理式」と呼称する．
\end{Note}

\section{変数の出現と代入可能性} \label{sec:substitution}

数学においては，一般論に具体例を当てはめることによって議論を進めることが多い．
これの形式的記号列の世界での対応物は，
項や論理式に登場する変数記号に別のものを当てはめることである．
この操作を定式化するためには，いくつかのステップを踏む必要がある．
なお，正確に書くとそれなりに議論が長くなるため，以下では相当にラフに記述していることに注意されたい．
ラフな部分はいずれも帰納的定義によって精密化できる．


\begin{Def} \label[Def]{Def:occurence}
	論理式
	\begin{align*}
		\varphi \colon \paren{\cdots \paren{\forall x \paren{\cdots x \cdots } \cdots}}, \\
		\psi \colon \paren{\cdots \paren{\exists x \paren{\cdots x \cdots } \cdots}}
	\end{align*}
	の変数記号\(x\)のように，\(\forall, \exists\)とともに出現している変数記号は
	その論理式に%
	\index[widx]{そくばくしゅつげん@束縛出現}%
	\term{束縛出現}しているといい，
	\(\forall, \exists\)をともなわずに出現している変数記号は
	その論理式に%
	\index[widx]{じゆうしゅつげん@自由出現}%
	\term{自由出現}しているという．
	また，論理式\(\varphi\)に束縛出現する変数記号全体の集合と\(\varphi\)に自由出現する変数記号全体の集合を，それぞれ%
	\index[sidx]{\(\apply{\BV}{\varphi}\)：論理式に束縛出現する変数記号全体の集合}%
	\index[sidx]{\(\apply{\FV}{\varphi}\)：論理式に自由出現する変数記号全体の集合}%
	\begin{align}
		\apply{\BV}{\varphi}, \\
		\apply{\FV}{\varphi}
	\end{align}
	と表す．%
	\index[sidx]{\(\apply{\Var}{t}\)：項に出現する変数記号全体の集合}%
	さらに，項\(t\)に出現する変数記号全体の集合を
	\begin{equation}
		\apply{\Var}{t}
	\end{equation}
	と表す．%
	\(\apply{\FV}{\varphi} = \emptyset\)であるような論理式\(\varphi\)は%
	\index[widx]{ろんりしき@論理式!へいろんりしき@閉---}%
	\term{閉論理式}，あるいは%
	\index[widx]{ぶん@文|see{閉論理式}}%
	\term{文}と呼ぶ．
	\(\apply{\Var}{t} = \emptyset\)となる項\(t\)は%
	\index[widx]{こう@項!へいこう@閉---}%
	\term{閉項}であるという．
\end{Def}

\begin{Note} \label[Note]{Note:languagesentence}
	言語\(\symcal{L}\)を明示する文脈においては
	閉論理式や文，閉項はそれぞれ\(\symcal{L}\)閉論理式，\(\symcal{L}\)文，\(\symcal{L}\)閉項と呼ぶ．
\end{Note}

\begin{Ex} \label[Ex]{Ex:occurence}
	群論の言語\(\symcal{L} = \set{\obj{\ast}, \obj{e}, {}^{\obj{-1}}}\)において，
	論理式
	\begin{equation*}
		\varphi \colon \paren{\forall \obj{a} \paren{\forall y \paren{
					\apply{\mathord{\obj{\ast}}}{\obj{x}, \obj{y}} \obj{\objeq} \apply{\mathord{\ast}}{\obj{y}, \obj{x}}
				}}}
	\end{equation*}
	に対しては
	\begin{align*}
		\apply{\BV}{\varphi} = \set{\obj{a}, \obj{y}}, \\
		\apply{\FV}{\varphi} = \set{\obj{x}}
	\end{align*}
	が成り立つ．この\(\obj{a}\)のように，
	\(\forall, \exists\)記号の直後でのみ出現する変数記号も束縛出現するとみなす．
\end{Ex}

以上の準備のもと，代入操作を定式化したいのだが，先に代入可能性について論ずる必要がある．

\index[widx]{だいにゅう@代入}
\begin{Def} \label[Def]{Def:cansubstitution}
	\(\varphi\)を論理式，\(x\)を変数記号，\(t\)を項とする．
	以下の2条件をともに満たす変数記号\(y\)が存在するとき，
	\(t\)は\(\varphi\)中の\(x\)に%
	\index[widx]{だいにゅう@代入!だいにゅうふかのう@---不可能}%
	\term{代入不可能}であるといい，
	そのような\(y\)が存在しないとき，
	\(t\)は\(\varphi\)中の\(x\)に%
	\index[widx]{だいにゅう@代入!だいにゅうかのう@---可能}%
	\term{代入可能}%
	であるという：
	\begin{itemize}
		\item \(\varphi\)が
		      \(\paren{\cdots \paren{\forall y \paren{\cdots x \cdots} \cdots} \cdots}\)
		      か
		      \(\paren{\cdots \paren{\exists y \paren{\cdots x \cdots} \cdots} \cdots}\)
		      の形の論理式である．ただし，この\(x\)は\(\varphi\)に自由出現しているものとする．
		\item \(y \in \apply{\Var}{t}\)である．
	\end{itemize}
\end{Def}

代入可能性については，例を見るのが手っ取り早い．

\begin{Ex} \label{Ex:cansubstitution}
	群論の言語\(\symcal{L} = \set{\obj{\ast}, \obj{e}, {}^{\obj{-1}}}\)において，
	論理式
	\begin{equation*}
		\varphi \colon \paren{\forall \obj{a} \paren{\forall y \paren{
					\apply{\mathord{\obj{\ast}}}{\obj{x}, \obj{y}} \obj{\objeq} \apply{\mathord{\ast}}{\obj{y}, \obj{x}}
				}}}
	\end{equation*}
	中の\(\obj{x}\)に項\(\apply{\obj{\ast}}{\obj{y}, \obj{e}}\)は代入不可能である．
	一方で，\(\obj{x}\)に項\(\obj{e}\)は代入可能である．
	また，\(\obj{a}, \obj{y}\)だけでなく
	\(\varphi\)に出現しない変数記号すべてに対してあらゆる項が代入可能である．
\end{Ex}

\begin{Def} \label[Def]{Def:substitution}
	論理式\(\varphi\)中の変数記号\(x\)に項\(t\)が代入可能であるとき，
	\(\varphi\)に自由出現している\(x\)すべてを\(t\)に置き換えて得られる論理式を
	\begin{equation}
		\subst{\varphi}{t/x}
	\end{equation}
	と表す．
\end{Def}

\begin{Ex} \label[Ex]{Ex:substitution}
	\Cref{Ex:cansubstitution}における\(\varphi\)において
	\begin{equation*}
		\subst{\varphi}{\obj{e} / \obj{x}} \colon
		\paren{\forall \obj{a} \paren{\forall \obj{y} \paren{
					\apply{\mathord{\obj{\ast}}}{\obj{e}, \obj{y}} \obj{\objeq} \apply{\mathord{\ast}}{\obj{y}, \obj{e}}
				}}}
	\end{equation*}
	である．また，\(\subst{\varphi}{\obj{e} / \obj{a}}\)と\(\subst{\varphi}{\obj{e} / \obj{y}}\)はいずれも\(\varphi\)そのものである．
\end{Ex}


\section{理論} \label[section]{sec:Theory}

前節までは項や論理式に関する一般論を述べた．
ここでは，実際の数学理論がどう形式化されるかについて少しだけ触れる．

\begin{Def} \label[Def]{Def:theory}
	\(\symcal{L}\)を言語とするとき，\(\symcal{L}\)文からなる集合を%
	\index[widx]{りろん@理論}%
	\(\symcal{L}\)\term{理論}，あるいは%
	\index[widx]{こうりけい@公理系}%
	\(\symcal{L}\)\term{公理系}
	という．
	言語\(\symcal{L}\)を明示しない文脈では，\(\symcal{L}\)理論や\(\symcal{L}\)公理系は単に理論や公理系と呼ばれる．
\end{Def}

\begin{Ex} \label[Ex]{Ex:grouptheory}
	群論の言語\(\symcal{L} = \set{\obj{\ast}, \obj{e}, {}^{\obj{-1}}}\)において，
	群の理論は次の3つの文からなると考えることができる：
	\begin{enumerate}
		\item \(\forall \obj{x} \forall \obj{y} \forall \obj{z}
		      \paren{\paren{\obj{x} \obj{\ast} \obj{y}} \obj{\ast} \obj{z} \objeq \obj{x} \obj{\ast} \paren{\obj{y} \obj{\ast} \obj{z}}}\),
		\item \(\forall \obj{x} \paren{\obj{e} \obj{\ast} \obj{x} \objeq \obj{x}}\),
		\item \(\forall \obj{x} \paren{\obj{x}^{\obj{-1}} \obj{\ast} \obj{x} \objeq \obj{e}}\)．
	\end{enumerate}
	ここで，\(\apply{{}^{\obj{-1}}}{\obj{x}}\)を\(\obj{x} ^ {\obj{-1}}\)と略記した．
\end{Ex}

\begin{Que} \label[Que]{Que:invalidtheory}
	群の言語を\(\symcal{L} = \set{\obj{\ast}}\)だと考えて，群の理論を次のように書き下そうとする場合がある．
	\begin{enumerate}
		\item \(\forall \obj{x} \forall \obj{y} \forall \obj{z}
		      \paren{\paren{\obj{x} \obj{\ast} \obj{y}} \obj{\ast} \obj{z} \objeq \obj{x} \obj{\ast} \paren{\obj{y} \obj{\ast} \obj{z}}},\)
		\item \(\exists \obj{e} \forall \obj{x} \paren{\obj{e} \obj{\ast} \obj{x} \objeq \obj{x}},\)
		\item \(\forall \obj{x} \exists \obj{y} \paren{\obj{y} \obj{\ast} \obj{x} \objeq \obj{e}}.\)
	\end{enumerate}
	しかし，この書き下し方は構文的に不適切である．その理由を述べよ．
\end{Que}
